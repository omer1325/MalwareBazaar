using MalwareBazaar.Core.Models;
using MalwareBazaar.Core.Services;

using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;

namespace MalwareBazaar.API.Controllers
{
    [Route("api/[controller]")]
    [ApiController]
    public class HashController : ControllerBase
    {

        private readonly IHashService<Hash> _hashService;
        public HashController(IHashService<Hash> hashService)
        {
            _hashService = hashService;
        }

        [HttpGet("sethash")]
        public async Task<IActionResult> SetHash()
        {
            await _hashService.SetAllMd5All();
            return Ok("Başarılı");
        }

        [HttpGet("gethash")]
        public async Task<IActionResult> GetHash()
        {
            return Ok(await _hashService.GetAllAsync());
        }

        [HttpGet("{id}")]
        public async Task<IActionResult> Delete(int id)
        {
            await _hashService.RemoveById(id);
            return Ok();
        }

        [HttpPut("update")]

        public IActionResult Update(Hash hash)
        {
            _hashService.Update(hash);
            return Ok();
        }
    }
}
